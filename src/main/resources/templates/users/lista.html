<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="fragments/layout :: layout('Usuários', ~{::section})">
<body>
<section>
    <div class="page-header animate-in">
        <div class="page-header-left">
            <div class="breadcrumb">
                <a th:href="@{/}" class="breadcrumb-link">Início</a>
                <span class="breadcrumb-sep"><i data-lucide="chevron-right"></i></span>
                <span>Usuários</span>
            </div>
            <h1 class="page-title">Usuários</h1>
            <p class="page-subtitle" th:text="${users?.size() ?: 0} + ' usuários cadastrados'">0 usuários</p>
        </div>
        <a th:href="@{/users/new}" class="btn btn-primary">
            <i data-lucide="user-plus"></i> Novo Usuário
        </a>
    </div>

    <div class="search-bar animate-up" style="animation-delay:0.1s">
        <i data-lucide="search" class="search-icon"></i>
        <input type="text" id="searchInput" class="search-input" placeholder="Buscar usuários por nome ou e-mail..." oninput="filterTable()"/>
    </div>

    <div th:if="${#lists.isEmpty(users)}" class="empty-state animate-up" style="animation-delay:0.2s">
        <i data-lucide="users" class="empty-icon"></i>
        <h3>Nenhum usuário cadastrado</h3>
        <p>Adicione usuários ao sistema.</p>
        <a th:href="@{/users/new}" class="btn btn-primary"><i data-lucide="user-plus"></i> Novo Usuário</a>
    </div>

    <div th:if="${!#lists.isEmpty(users)}" class="table-wrapper animate-up" style="animation-delay:0.2s">
        <table class="table" id="mainTable">
            <thead>
            <tr>
                <th>#</th>
                <th>Usuário</th>
                <th>E-mail</th>
                <th>Criado em</th>
                <th>Ações</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="user, iter : ${users}" class="table-row">
                <td class="table-id" th:text="${iter.index + 1}">1</td>
                <td>
                    <div class="table-title-cell">
                        <div class="table-avatar user-avatar" th:text="${#strings.substring(user.name, 0, 1)}">U</div>
                        <span class="table-title" th:text="${user.name}">Nome</span>
                    </div>
                </td>
                <td th:text="${user.email}">email@exemplo.com</td>
                <td th:text="${user.createdAt != null ? #temporals.format(user.createdAt, 'dd/MM/yyyy') : '—'}">—</td>
                <td>
                    <div class="action-group">
                        <a th:href="@{/users/{id}/edit(id=${user.id})}" class="btn-icon btn-edit" title="Editar usuário">
                            <i data-lucide="pencil"></i>
                        </a>
                        <form th:action="@{/users/{id}/deletar(id=${user.id})}" method="post" onsubmit="return confirmDelete(event)">
                            <button type="submit" class="btn-icon btn-delete" title="Excluir usuário">
                                <i data-lucide="trash-2"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</section>
</body>
</html>